- 描述了利用浏览器中应用程序层资源池限制的池方隐蔽通道攻击
- 证明池方攻击是实用的，可以用来跟踪所有流行浏览器中的用户

# 1 Introduction

证明当前的浏览器不能防止网站使用隐蔽通道来规避 浏览器反跟踪

利用浏览器中 有限但未分区的资源池的状态 来构建隐蔽通道

**池方攻击：**隐蔽通道是由同一资源池中两方共用

当资源池受到限制且尚未分区时 站点可以消耗和释放资源以泄露信息跨越安全边界

通过三个资源池 演示了"池方"攻击：WebSockets、服务器发送 事件和 Web Workers，并发现所有浏览器都容易 受到至少一种形式的攻击

## 1.1 Contributions

- 提出一种新的 **池方攻击** 方式 与当前旨在防御的隐私攻击不同
- 评估发现当前所有浏览器都容易受到池方攻击
- 提供三种攻击方式 评估实用性 探讨防御

## 1.2 Responsible Disclosure

# 2 "Pool-party": Definition and Background

介绍池方攻击与其他Web跟踪技术的关系 为什么现有的浏览器保护措施无法保护用户免受池方攻击

## 2.1 网页追踪与跨站追踪

指网站在用户没有同意情况下 追踪用户活动

## 2.2 第一方网站作为隐私边界

大部分浏览器使用第一方网站作为隐私边界

## 2.3 池方攻击描述

- 资源池有限：限制浏览器一次可以使用多少资源
- 未分区：不同的上下文从同一池中消耗资源

## 2.4 与其他隐私通道关系

池方攻击针对的是应用程序级别的资源 而其他隐私通道攻击的目标是系统以下的部分 因为攻击者攻击目标层次越低 资源与其他参与者共享的可能性越大 存在噪声

## 2.5 与其他跟踪方法的关系

### 有状态跟踪

池方攻击不依赖于设置或检索浏览器状态 依赖于浏览器架构的实现细节

### 无状态跟踪

攻击者将大量半区分的浏览器和环境属性组合成一个稳定唯一的标识符

攻击性质差异：无状态目标是由页面执行环境设置的稳定的半区分浏览器特性 池方是通过站点在执行上下文中消耗和读取浏览器中有限资源的可用性来实现的

### XS跨站泄露

池方攻击与xs泄露类似

<aside>
💡 **对比贡献**

- 池方攻击定义了比xs更大的攻击类别 其中任何有限但未分区的资源池都可以转换为隐蔽通道 xs攻击是池方大类攻击的一个子集
- 证明池方攻击实用性
- 池方攻击范围更广
</aside>

# 3 Generic "Pool-party" Attack Algorithm

可以应用于满足以下条件的资源池

- 有限资源池
- 资源池不分区
- 网站不受限从池中消耗资源
- 消耗资源后 网站可以将任意数量资源释放回池中

## 3.1 "Pool-party" Algorithm

### 输入

1. `POOL_SIZE` 资源池的大小
    1. `PKT_SIZE`  log(`POOL_SIZE` )
2. MSG 通过通道发送的消息
3. `NEGOTIATE_INTERVAL`  选择发送方和接收方角色的时间
`PULSE_INTERVAL`   传输数据块的时间
两个时间间隔

### 第一步

发送方：`MSG`分成`PKT_SIZE`大小的块 → `CHUNKS`

接收方：`RECV_MSG` 将接收到的消息一次累积到一个数据包中

### 第二步：确定初始发送方和接收方

通过休眠同步 直到`START_TIME`

能够消耗资源池中50%以上资源的站点为初始发送者 另一个为接收者

接收方释放其持有的资源 发送方不断消耗直至耗尽

### 第三步：发送数据

遍历`CHUNKS` 存放的是一个个二进制字符串

    if 发送方

        编码二进制字符串（`CHUNKS[i]`）为 `SEND_INT`
        
        消耗全部资源
        
        释放`SEND_INT` 资源
    
    else 接收方
    
        消耗全部资源
        
        消耗资源数（`SEND_INT` ） → `RECV_INT`
        
        释放持有的全部资源
        
        解码`RECV_INT` 为 `RECV_STR`

动态地创建和销毁资源以编码和传输二进制数据。发送方和接收方可以协商一种通信协议，例如通过资源池中资源的数量或状态来传递消息。

# 4 Evaluation in Popular Browsers

将有限但未分区的资源池转变为跨上下文通信通道，而该通道又可用于 cookie 同步和跨 Web 跟踪用户

三个资源池：

websocket 

SSE

web workers api

四个标准确定攻击实用性：

1. 可用性
2. 带宽
3. 一致性
4. 背景噪声

## 4.1 Attack Availability

测试web api是否会泄露以及资源池是否会按预期耗尽

1. 在一个空白页面 重复实例化测试 Web API 是否在有限且可预测的调用次数后导致错误
2. 当池用完 在新站点下查看是否有更多可用资源
3. 如果在一站点下释放一个资源 是否在二站点下无错误消耗单个资源
4. 是否

测试是否可以使用资源池来创建隐蔽通道并跨站点边界、跨配置文件边界通信，或两者皆可

测试是否可用于在标准 浏览配置文件和"私人浏览模式"配置文件之间 进行通信

### 结果：

能够在所有主要浏览器中识别可利用的有限但未分区的资源池

每个浏览器引擎的目标资源池都不同。我们能够利用基于 Chromium 和 Gecko 的浏览器中相对较大的 WebSocket 连接 池来进行"池方"攻击。 Safari 的 WebSockets 实现无法被利用

基于 Gecko 的浏览器比其他浏览器引擎更容易受到"池方"攻 击。

虽然"池方"攻击可用于所有浏览器中的跨站点跟踪，但在基于Gecko的浏览器中，"池方"攻击可用于跨配置文件跟踪用户

## 4.2 Attack Bandwidth

### 方法

通过测量实施"池方"攻击的时间来测量攻击的带宽

在两个标签页之间测试 改变协商时间脉冲时间 找到最短时间

### 结果

资源池中可用资源的数量限制了攻击能够传输的数据量，因此带宽会受到这些限制的影响

## 4.3 Attack Consistency

### 方法

评估在浏览器上没有其他网站运行的情况下的一致性。因为有其他站点会降低成功率。

在单个浏览器实例的两个不同页面上运行攻击 100 次，每次都使用干净的配置文件——正确接收 35 位字符串的次数百分比

### 结果

攻击的稳定性和一致性受到资源池中资源数量的限制，因为这会影响攻击的带宽和正确性

攻击实现中存在的一些异常行为，如资源池大小的漂移和反馈延迟，也可能影响攻击的一致性

为了最小化这些异常的影响，研究人员采取了一些措施，如重复尝试消耗资源以确保正确性，并引入延迟以处理反馈延迟

## 4.4 Attack Background Noise

### 方法

背景噪声指的是由于其他站点或浏览器进程的资源使用而引入的干扰。

### 结果

table 5：绝大多数网站使用资源池而不会受到其他页面的任何干扰

攻击期间网站使用此资源池不会影响正确性 只会影响带宽

只有…… 才会影响正确性

攻击完成得越快，就越不容易受到背景噪声的影响 此外可以多次进行攻击 获取大多数结果

# 5 Discussion

## 5.1 Implementation Challenges

一个有限但未分区的资源池，其资源可以被网页中的脚本消耗和释放，足以跨站点通信

## 5.2 Drifting Resource Pool Limit

某些情况下，资源池的总体限制可能会发生漂移。这意味着资源池的大小不是严格固定的，而是可能会随着时间变化。

## 5.3 Additional Attack Vectors

除了 WebSockets、Web Workers 和 Server-Sent Events 等资源池之外，浏览器中还存在许多其他的攻击机会。例如，Chromium 的 DNS 解析器和 HTTP 代理，以及在 Chromium、Gecko 和 WebKit 中的其他 API 封装

## 5.4 Defenses and Constraints

具有一定的挑战性。由于系统总是具有有限的资源，因此某些底层的限制性但未分割的资源池始终可以被充分动机的一方利用

一些可能的防御措施，例如增加资源池的大小、资源池的分割，以及同时采用这两种方法的混合方法

## 5.5 Applicability to Mobile

 "pool-party" 攻击在移动设备上的可用性与在桌面版本上是一致的

# 6 Related Work

1. **在线跟踪和特征滥用：** 许多研究关注浏览器功能如何被在线跟踪器（trackers）滥用，以达到浏览器供应商未曾预期的跟踪用户的目的。这包括浏览器指纹识别、跨站点信息泄露等方面的工作。先前的研究发现，浏览器功能如画布操作、字体安装、WebAudio 和 WebRTC API 等都可以被用于跟踪用户。
2. **防御机制：** 除了揭示滥用浏览器功能的研究外，还有一些工作致力于防止浏览器指纹识别和跟踪。这些方法包括操纵常见 Web API 返回值、向 Web Audio 和 Canvas API 引入噪声、禁用成本高于受益的 Web API 等。
3. **攻击浏览器分区和沙箱：** 这些工作涵盖了攻击浏览器分区机制的方法。研究人员发现，许多分区措施可以被绕过，使站点能够窥探用户在其他站点上的行为。这包括利用浏览器中的计时方法、缓存状态、SVG 渲染等来实现的攻击。

# 7 Conclusions

论文分析了浏览器中的资源池，包括WebSockets、Web Workers和Server-Sent Events等。作者提出了一种名为“pool-party”的算法，该算法使得攻击者能够在资源池中进行数据传输，并实施跨站点通信。论文还详细描述了算法的四个步骤：建立、确定初始发送方和接收方、发送数据以及交换角色

此外，论文还讨论了实施“pool-party”攻击所面临的挑战，包括资源池限制的漂移、延迟反馈和背景噪音等。作者还提出了一些防御和限制攻击的方法，例如扩大资源池的大小、对资源池进行分区以及限制每个站点或上下文的资源使用量

最后，论文还总结了“pool-party”攻击对Web隐私的影响，指出隐私攻击日益普遍，但隐私防御措施也在不断加强。作者希望通过这项研究，加强对Web隐私问题的认识，并促进对隐私保护措施的改进和加强
